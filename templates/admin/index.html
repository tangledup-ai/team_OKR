{% extends "admin/index.html" %}
{% load i18n static %}

{% block content %}
{% if stats %}
<div class="stats-container" style="margin-bottom: 30px;">
    <h2 style="color: #007BFF; margin-bottom: 20px;">ğŸ“Š ç³»ç»Ÿæ¦‚è§ˆ</h2>
    
    <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 20px;">
        <div class="stats-item" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
            <div><strong style="font-size: 24px; color: white;">{{ stats.total_users }}</strong></div>
            <div>æ€»ç”¨æˆ·æ•°</div>
        </div>
        <div class="stats-item" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white;">
            <div><strong style="font-size: 24px; color: white;">{{ stats.active_users }}</strong></div>
            <div>æ´»è·ƒç”¨æˆ·</div>
        </div>
        <div class="stats-item" style="background: linear-gradient(135deg, #17a2b8 0%, #6f42c1 100%); color: white;">
            <div><strong style="font-size: 24px; color: white;">{{ stats.total_tasks }}</strong></div>
            <div>æ€»ä»»åŠ¡æ•°</div>
        </div>
        <div class="stats-item" style="background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%); color: white;">
            <div><strong style="font-size: 24px; color: white;">{{ stats.completed_tasks }}</strong></div>
            <div>å·²å®Œæˆä»»åŠ¡</div>
        </div>
        <div class="stats-item" style="background: linear-gradient(135deg, #007bff 0%, #6610f2 100%); color: white;">
            <div><strong style="font-size: 24px; color: white;">{{ stats.in_progress_tasks }}</strong></div>
            <div>è¿›è¡Œä¸­ä»»åŠ¡</div>
        </div>
        <div class="stats-item" style="background: linear-gradient(135deg, #e83e8c 0%, #fd7e14 100%); color: white;">
            <div><strong style="font-size: 24px; color: white;">{{ stats.total_reviews }}</strong></div>
            <div>æ€»è¯„ä»·æ•°</div>
        </div>
        <div class="stats-item" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%); color: white;">
            <div><strong style="font-size: 24px; color: white;">{{ stats.total_evaluations }}</strong></div>
            <div>æœˆåº¦è¯„ä»·æ•°</div>
        </div>
        {% if stats.pending_admin_evaluations > 0 %}
        <div class="stats-item" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white;">
            <div><strong style="font-size: 24px; color: white;">{{ stats.pending_admin_evaluations }}</strong></div>
            <div>å¾…ç®¡ç†å‘˜è¯„ä»·</div>
        </div>
        {% endif %}
    </div>
    
    {% if dept_stats %}
    <div style="margin-top: 20px;">
        <h3 style="color: #6c757d; margin-bottom: 15px;">ğŸ‘¥ éƒ¨é—¨åˆ†å¸ƒ</h3>
        <div style="display: flex; gap: 15px;">
            {% for dept in dept_stats %}
            <div class="stats-item">
                <div><strong style="font-size: 20px;">{{ dept.count }}</strong></div>
                <div>
                    {% if dept.department == 'hardware' %}ç¡¬ä»¶éƒ¨é—¨
                    {% elif dept.department == 'software' %}è½¯ä»¶éƒ¨é—¨
                    {% elif dept.department == 'marketing' %}å¸‚åœºéƒ¨é—¨
                    {% else %}{{ dept.department }}{% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>

{% if recent_tasks or recent_reviews %}
<div style="display: flex; gap: 30px; margin-bottom: 30px;">
    {% if recent_tasks %}
    <div style="flex: 1; background: #f8f9fa; padding: 20px; border-radius: 5px;">
        <h3 style="color: #007BFF; margin-bottom: 15px;">ğŸ“‹ æœ€æ–°ä»»åŠ¡</h3>
        {% for task in recent_tasks %}
        <div style="padding: 10px; margin-bottom: 10px; background: white; border-radius: 3px; border-left: 4px solid #007BFF;">
            <strong>{{ task.title }}</strong><br>
            <small style="color: #6c757d;">
                è´Ÿè´£äºº: {{ task.owner.name }} | 
                çŠ¶æ€: {{ task.get_status_display }} | 
                {{ task.created_at|date:"m-d H:i" }}
            </small>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    {% if recent_reviews %}
    <div style="flex: 1; background: #f8f9fa; padding: 20px; border-radius: 5px;">
        <h3 style="color: #28a745; margin-bottom: 15px;">ğŸ’¬ æœ€æ–°è¯„ä»·</h3>
        {% for review in recent_reviews %}
        <div style="padding: 10px; margin-bottom: 10px; background: white; border-radius: 3px; border-left: 4px solid #28a745;">
            <strong>{{ review.get_type_display }} - {{ review.rating }}åˆ†</strong><br>
            <small style="color: #6c757d;">
                è¯„ä»·äºº: {{ review.reviewer.name }} | 
                {{ review.created_at|date:"m-d H:i" }}
            </small>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>
{% endif %}
{% endif %}

{{ block.super }}

<style>
.stats-item {
    display: inline-block;
    padding: 20px;
    background: white;
    border-radius: 8px;
    border-left: 4px solid #007BFF;
    text-align: center;
    min-width: 120px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transition: transform 0.2s;
}

.stats-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}

.stats-container {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 25px;
    margin: 20px 0;
}
</style>
{% endblock %}